<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
<script>
    
    var socket = io();

    socket.on("disconnect",()=>{
        console.log("Desconectado")
    });

    function get_Hour(){
   
        socket.on("server_time",(data)=> {
            console.log(`Hora: ${data}`);
        })
    }

    socket.on("showmsg", (data) => {
        console.log(data);
        var chat = document.getElementById("chat")
        var p = document.createElement("p");
        p.innerHTML = '<b><em>'+ data.hour+ '</em></b>' +"     " + data.username + ": " + data.msg;
        chat.append(p);
        playSound('/sound/notification_sound.mp3');
    })

function get_Hour(){
    function padTo2Digits(num) {
        return String(num).padStart(2, '0');
    }
    
    const date = new Date();
    
    function padTo2Digits(num) {
        return String(num).padStart(2, '0');
    }
    const current =  padTo2Digits(date.getHours()) + ':' + padTo2Digits(date.getMinutes());

    return current
}



    function enviar(){
        var hour = get_Hour();
        var msgField = document.getElementById("msg");
        var usernameField = document.getElementById("username");

        var msg = msgField.value;
        var username = usernameField.value;

        socket.emit("msg",{msg: msg,username: username, hour: hour})
        
    }
const playSound = (url) => {
 const audio = new Audio(url);
 audio.play();
}


  

</script>

</html>